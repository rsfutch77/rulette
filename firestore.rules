rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // =============================================================================
    // DAILY TRANSACTIONS COLLECTION (Global Killswitch)
    // =============================================================================
    match /dailyTransactions/{date} {
      // Temporarily setting killswitch to true for development.
      // TODO: Revert to checking dailyTransactions/$(getTodayDate()).data.killswitchActive
      allow read: if true;
      // Allow write access only to authenticated server-side processes (e.g., Firebase Functions)
      // For now, deny all client writes. A Firebase Function will manage this.
      allow write: if false; // TODO: Implement server-side write rule for Firebase Function
    }

    // =============================================================================
    // GAME SESSIONS COLLECTION (Temporarily open due to killswitch)
    // =============================================================================
    match /gameSessions/{sessionId} {
      allow read, write: if true; // Temporarily open for development
    }
    
    // =============================================================================
    // PLAYERS COLLECTION (Temporarily open due to killswitch)
    // =============================================================================
    match /players/{playerId} {
      allow read, write: if true; // Temporarily open for development
    }

    // =============================================================================
    // DEFAULT DENY ALL
    // =============================================================================
    
    // Deny all other operations by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}